<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Favorite vs Competitor Hedge Calculator PWA</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#317EFB">

  <!-- Bootstrap CSS via CDN -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    /* Make sliders bigger for mobile */
    .form-range {
      height: 2rem;
    }
    .form-range::-webkit-slider-thumb {
      width: 24px;
      height: 24px;
    }
    .form-range::-moz-range-thumb {
      width: 24px;
      height: 24px;
    }
  </style>

  <!-- Inline manifest -->
  <link rel="manifest" href="data:application/manifest+json,{
    &quot;name&quot;:&quot;HedgeCalc PWA&quot;,
    &quot;short_name&quot;:&quot;HedgeCalc&quot;,
    &quot;start_url&quot;:&quot;.&quot;,
    &quot;display&quot;:&quot;standalone&quot;,
    &quot;background_color&quot;:&quot;#ffffff&quot;,
    &quot;theme_color&quot;:&quot;#317EFB&quot;,
    &quot;icons&quot;:[]
  }">
</head>
<body class="container py-4">

  <div class="card shadow" id="calculator">
    <div class="card-header d-flex justify-content-between align-items-center">
      <h5 class="mb-0">Favorite vs Competitor Hedge Calculator</h5>
      <button id="closeBtn" class="btn btn-sm btn-danger" onclick="dismissCalc()">×</button>
    </div>
    <div class="card-body">
      <p class="text-muted">Adjust stakes and odds for the Favorite and Competitor. Net gain/loss is shown for both win and lose scenarios, plus overall.</p>

      <!-- Favorite -->
      <h6 class="mt-3">Favorite</h6>
      <div class="mb-3">
        <label class="form-label">Stake ($): <span id="stakeAVal">100</span></label>
        <input type="range" class="form-range" id="stakeA" min="10" max="500" step="10" value="100"
               oninput="document.getElementById('stakeAVal').innerText=this.value; calculate();">
      </div>
      <div class="mb-3">
        <label class="form-label">Odds (American): <span id="oddsAVal">-120</span></label>
        <input type="range" class="form-range" id="oddsA" min="-200" max="300" step="10" value="-120"
               oninput="updateOddsLabel('oddsAVal', this.value); calculate();">
      </div>

      <!-- Competitor -->
      <h6 class="mt-3">Competitor</h6>
      <div class="mb-3">
        <label class="form-label">Stake ($): <span id="stakeBVal">100</span></label>
        <input type="range" class="form-range" id="stakeB" min="10" max="500" step="10" value="100"
               oninput="document.getElementById('stakeBVal').innerText=this.value; calculate();">
      </div>
      <div class="mb-3">
        <label class="form-label">Odds (American): <span id="oddsBVal">+150</span></label>
        <input type="range" class="form-range" id="oddsB" min="-200" max="300" step="10" value="150"
               oninput="updateOddsLabel('oddsBVal', this.value); calculate();">
      </div>

      <div class="alert alert-secondary mt-3" id="result"></div>
    </div>
  </div>

  <!-- Bootstrap JS bundle -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    function updateOddsLabel(labelId, val) {
      document.getElementById(labelId).innerText = (val > 0 ? '+'+val : val);
    }

    function payoutMultiplier(odds) {
      odds = parseInt(odds, 10);
      return odds > 0 ? (odds / 100) + 1 : (100 / -odds) + 1;
    }

    function calculate() {
      const stakeA = parseFloat(document.getElementById('stakeA').value);
      const oddsA = parseInt(document.getElementById('oddsA').value, 10);
      const stakeB = parseFloat(document.getElementById('stakeB').value);
      const oddsB = parseInt(document.getElementById('oddsB').value, 10);

      const payoutA = stakeA * payoutMultiplier(oddsA);
      const payoutB = stakeB * payoutMultiplier(oddsB);

      const totalStake = stakeA + stakeB;

      const netAWin = payoutA - totalStake;
      const netALose = -stakeA + (stakeB > 0 ? payoutB - stakeB : 0);
      const netBWin = payoutB - totalStake;
      const netBLose = -stakeB + (stakeA > 0 ? payoutA - stakeA : 0);

      const overall = (netAWin + netBWin) / 2;
      const overallStatus = overall >= 0 ? "Profit" : "Loss";

      document.getElementById('result').innerHTML =
        `<strong>If Favorite wins:</strong> Net = <span class="${netAWin>=0?'text-success':'text-danger'}">$${netAWin.toFixed(2)}</span><br>
         <strong>If Favorite loses:</strong> Net = <span class="${netALose>=0?'text-success':'text-danger'}">$${netALose.toFixed(2)}</span><br><br>
         <strong>If Competitor wins:</strong> Net = <span class="${netBWin>=0?'text-success':'text-danger'}">$${netBWin.toFixed(2)}</span><br>
         <strong>If Competitor loses:</strong> Net = <span class="${netBLose>=0?'text-success':'text-danger'}">$${netBLose.toFixed(2)}</span><br><hr>
         <strong>Total Net (average):</strong> <span class="${overall>=0?'text-success':'text-danger'}">$${overall.toFixed(2)} → ${overallStatus}</span>`;
    }

    function dismissCalc() {
      document.getElementById('calculator').style.display = 'none';
    }

    // Minimal service worker inline
    const swCode = `
      self.addEventListener('install', event => {
        event.waitUntil(
          caches.open('pwa-cache').then(cache => cache.addAll(['./']))
        );
      });
      self.addEventListener('fetch', event => {
        event.respondWith(
          caches.match(event.request).then(resp => resp || fetch(event.request))
        );
      });
    `;
    const blob = new Blob([swCode], { type: 'application/javascript' });
    const swUrl = URL.createObjectURL(blob);
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register(swUrl);
    }

    window.onload = calculate;
  </script>
</body>
</html>